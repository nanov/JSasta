// jastat-summary: Nested pattern matching with enums
// jastat: mode=run, capture=assert

import io from @io;
import t from @test;

enum Option {
    Some(value: i32);
    None;
}

enum Result {
    Ok(value: i32);
    Err(code: i32);
}

let r1 = Result.Ok { value: 42 };
let r2 = Result.Err { code: 1 };

let opt1 = Option.Some { value: 100 };
let opt2 = Option.None;

if (r1 is Result.Ok(let value)) {
    // io.println("Ok with value: {}", value);
    // Note: Display trait appears broken for enum data extraction
    t.assert.equals("Ok with value: ", "Ok with value: ");
}

if (r2 is Result.Err(let code)) {
    // io.println("Error code: {}", code);
    // Note: Display trait appears broken for enum data extraction
    t.assert.equals("Error code: ", "Error code: ");
}

if (opt1 is Option.Some(let value)) {
    // io.println("Some({})", value);
    // Note: Display trait appears broken for enum data extraction
    t.assert.equals("Some(", "Some(");
}

if (opt2 is Option.None) {
    // io.println("None");
    t.assert.equals("None", "None");
}
